div#searchContainer
	script(ng-controller="RegisterCtrl", type="text/ng-template")#myModalContent
		form(ng-submit="register()", role="form").form-horizontal
			div.modal-header
				h3.modal-title Register a new reference sample
			tabset(justified="true")
				tab(heading="Metadata")
					div.modal-body
						div.row.uigroup
							div.group.col-sm-6
								div.form-group
									label.col-sm-4.control_label Sample type
									div.col-sm-8
										catsmultiselect(ng-model="record.sampleType", options="c.name c.dkname group by c.grp for c in sampleTypes",
											ms-header="Select sample type")
								div.form-group 
									label.col-sm-4.control_label Ref. number
									div.col-sm-8
										input(type="text", ng-model="record.referenceNumber", required).form-control
								div.form-group 
									label.col-sm-4.control_label Sample origin
									div.col-sm-8
										input(type="text", ng-model="record.originLocation").form-control
								div.form-group 
									label.col-sm-4.control_label Sample date
									div(ng-controller="DatepickerCntrl").col-sm-8
										div.input-group
											input(type="text", datepicker-popup="{{format}}", ng-model="record.sampleDate", is-open="opened", min-date="minDate", max-date="'2015-06-22'", datepicker-options="dateOptions", date-disabled="disabled(date, mode)", close-text="Close").form-control
											span.input-group-btn
												button(type="button", ng-click="open($event)").btn.btn-default: i.glyphicon.glyphicon-calendar
								div.form-group 
									label.col-sm-4.control_label Employee
									div.col-sm-8
										input(type="text", ng-model="record.employee").form-control
							div.group.col-sm-6
								div.form-group 
									label.col-sm-4.control_label Institution
									div.col-sm-8
										catsmultiselect(ng-model="record.owner", options="c.name c.dkname group by c.grp for c in sampleOwners",
											ms-header="Select sample owner")
								div.form-group 
									label.col-sm-4.control_label Sample location
									div.col-sm-8
										input(type="text", ng-model="record.sampleLocation").form-control
								div.form-group 
									label.col-sm-4.control_label Remarks
									div.col-sm-8
										textarea(rows="3", ng-model="record.remarks").form-control
						div(ng-switch on="record.sampleType.id")
							div(ng-switch-when="paint")
								div.row.uigroup
									tabset
										tab(ng-repeat="paintLayer in record.paintLayer", active="paintLayer.active")
											tab-heading
												{{paintLayer.layerType.name}} Layer 
												a(ng-click="removeLayerTab($index)", href=''): i.glyphicon.glyphicon-remove
											div.embeddedTab
												div.group.col-sm-6
													div.form-group
														label.col-sm-4.control_label Type
														div.col-sm-8.control_label.multi
															catsmultiselect(ng-model="paintLayer.layerType", options="c.name c.dkname group by c.grp for c in layerTypes",
															ms-header="Select layer type")
													div.form-group
														label.col-sm-4.control_label Binders
														div.col-sm-8.control_label.multi
															catsmultiselect(multiple="true", ng-model="paintLayer.paintBinder", options="c.name c.dkname group by c.grp for c in paintBinders",
															ms-header="Select binders").multi
													div(ng-show="paintLayer.layerType.name == 'Ground'").form-group
														label.col-sm-4.control_label Ground type
														div.col-sm-8.control_label.multi
															catsmultiselect(multiple="true", ng-model="paintLayer.paintGroundType", options="c.name c.dkname group by c.grp for c in groundTypes",
															ms-header="Select ground type").multi
												div.group.col-sm-6
													div.form-group
														label.col-sm-4.control_label Colours
														div.col-sm-8.control_label.multi
															catsmultiselect(multiple="true", ng-model="paintLayer.colour", options="c.name c.dkname group by c.grp for c in colours",
															ms-header="Select colours").multi
													div.form-group
														label.col-sm-4.control_label Pigments
														div.col-sm-8.control_label.multi
															catsmultiselect(multiple="true", ng-model="paintLayer.pigment", options="c.name c.dkname group by c.grp for c in pigments",
															ms-header="Select pigments").multi
													div.form-group
														label.col-sm-4.control_label Dyes
														div.col-sm-8.control_label.multi
															catsmultiselect(multiple="true", ng-model="paintLayer.dye", options="c.name c.dkname group by c.grp for c in dyes",
															ms-header="Select dyes").multi
										tab(select="addLayer()")
											tab-heading
												i.glyphicon.glyphicon-plus
								div.row
									div.group.col-sm-12
										div.form-group 
											label.col-sm-2.control_label Paint layers description
											div.col-sm-10
												textarea(rows="3", ng-model="record.paintLayerDescription").form-control
								div.row
									div.group.col-sm-6
										div.form-group 
											label.col-sm-4.control_label 
											div.col-sm-8
												label.checkbox-inline.control_label Priming
													input(type="checkbox", ng-model="record.paintPriming")
							div(ng-switch-when="fibre")
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Fibre Type
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.fibreType", options="c.name c.dkname group by c.grp for c in fibreTypes",
												ms-header="Select fibre").multi
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Glue
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.fibreGlue", options="c.name c.dkname group by c.grp for c in fibreGlueTypes",
												ms-header="Select glue").multi
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label 
											div.col-sm-8
												label.checkbox-inline.control_label Ligin
													input(type="checkbox", ng-model="record.fibreLigin")
												label.checkbox-inline.control_label Alum
													input(type="checkbox", ng-model="record.fibreAlum")
												label.checkbox-inline.control_label Filler
													input(type="checkbox", ng-model="record.fibreFiller")
							div(ng-switch-when="material")
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Material Type
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.materialType", options="c.name c.dkname group by c.grp for c in materialTypes",
												ms-header="Select material").multi
							div(ng-switch-when="stretcher")
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Type
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.stretcherType", options="c.name c.dkname group by c.grp for c in stretcherTypes",
												ms-header="Select type").multi
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Material Type
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.stretcherMaterialType", options="c.name c.dkname group by c.grp for c in stretcherMaterialTypes",
												ms-header="Select material").multi
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Condition
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.stretcherCondition", options="c.name c.dkname group by c.grp for c in stretcherConditions",
												ms-header="Select condition").multi
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Joint Technique
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.stretcherJointTechnique", options="c.name c.dkname group by c.grp for c in stretcherJointTechniques",
												ms-header="Select joint technique").multi
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Dimensions
											div.col-sm-8
												input(type="text", ng-model="record.dimensions").form-control
									div.group.col-sm-6
										div.form-group 
											label.col-sm-4.control_label Production date
											div(ng-controller="DatepickerCntrl").col-sm-8
												div.input-group
													input(type="text", datepicker-popup="{{format}}", ng-model="record.productionDate", is-open="opened", min-date="minDate", max-date="'2015-06-22'", datepicker-options="dateOptions", date-disabled="disabled(date, mode)", close-text="Close").form-control
													span.input-group-btn
														button(type="button", ng-click="open($event)").btn.btn-default: i.glyphicon.glyphicon-calendar
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Source
											div.col-sm-8
												input(type="text", ng-model="record.source").form-control
							div(ng-switch-when="pigment")
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Colour Classification
											div.col-sm-8
												input(type="text", ng-model="record.pigmentColourClass").form-control
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Source/Manufacturer
											div.col-sm-8
												input(type="text", ng-model="record.pigmentSourcer").form-control
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Production no./Batch no.
											div.col-sm-8
												input(type="text", ng-model="record.pigmentProdNumber").form-control
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Secondary provenance
											div.col-sm-8
												input(type="text", ng-model="record.pigmentSecondryProvenance").form-control
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label  Place of origin
											div.col-sm-8
												input(type="text", ng-model="record.pigmentOrigin").form-control
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label  Chemical composition 
											div.col-sm-8
												input(type="text", ng-model="record.pigmentComposition").form-control
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Name
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.pigmentName", options="c.name c.dkname group by c.grp for c in pigmentNames",
												ms-header="Select name").multi	
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Other Name
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.pigmentOtherName", options="c.name c.dkname group by c.grp for c in pigmentNames",
												ms-header="Select name").multi
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Form
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.pigmentForm", options="c.name c.dkname group by c.grp for c in pigmentForms",
												ms-header="Select form").multi	
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Production date
											div(ng-controller="DatepickerCntrl").col-sm-8
												div.input-group
													input(type="text", datepicker-popup="{{format}}", ng-model="record.productionDate", is-open="opened", min-date="minDate", max-date="'2015-06-22'", datepicker-options="dateOptions", date-disabled="disabled(date, mode)", close-text="Close").form-control
													span.input-group-btn
														button(type="button", ng-click="open($event)").btn.btn-default: i.glyphicon.glyphicon-calendar
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Container
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.pigmentContainer", options="c.name c.dkname group by c.grp for c in pigmentContainers",
												ms-header="Select container").multi	
							div(ng-switch-when="xray")
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Type
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.xrayType", options="c.name c.dkname group by c.grp for c in xrayTypes",
												ms-header="Select type").multi	
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Film Type
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.xrayFilmType", options="c.name c.dkname group by c.grp for c in xrayFilmTypes",
												ms-header="Select film type").multi	
								div.row.uigroup
									tabset
										tab(ng-repeat="xrayGroup in record.xrayGroup", active="xrayGroup.active")
											tab-heading
												| Group {{$index}} 
												a(ng-click="removeXrayTab($index)", href=''): i.glyphicon.glyphicon-remove
											div.embeddedTab
												div.group.col-sm-6
													div.form-group
														label.col-sm-4.control_label Kv
														div.col-sm-8
															input(type="text", ng-model="xrayGroup.kv").form-control
													div.form-group
														label.col-sm-4.control_label Time
														div.col-sm-8
															input(type="text", ng-model="xrayGroup.time").form-control
												div.group.col-sm-6
													div.form-group
														label.col-sm-4.control_label mA
														div.col-sm-8
															input(type="text", ng-model="xrayGroup.ma").form-control	
													div.form-group
														label.col-sm-4.control_label Focus
														div.col-sm-8
															input(type="text", ng-model="xrayGroup.focus").form-control
												div.group.col-sm-6
													div.form-group
														label.col-sm-4.control_label Distance
														div.col-sm-8
															input(type="text", ng-model="xrayGroup.distance").form-control
													div.form-group 
														label.col-sm-4.control_label 
														div.col-sm-8
															label.checkbox-inline.control_label Test
																input(type="checkbox", ng-model="xrayGroup.test")
												div.group.col-sm-6
													div.form-group
														label.col-sm-4.control_label Filter
														div.col-sm-8.control_label.multi
															catsmultiselect(ng-model="xrayGroup.filter", options="c.name c.dkname group by c.grp for c in xrayFilters",
															ms-header="Select filter").multi
										tab(select="addXray()")
											tab-heading
												i.glyphicon.glyphicon-plus
							div(ng-switch-when="photograph")
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Type
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.mediaType", options="c.name c.dkname group by c.grp for c in mediaTypes",
												ms-header="Select type").multi	
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Film
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.mediaFilm", options="c.name c.dkname group by c.grp for c in mediaFilms",
												ms-header="Select film type").multi	
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Format
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.mediaFormat", options="c.name c.dkname group by c.grp for c in mediaFormats",
												ms-header="Select format").multi	
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Filter
											div.col-sm-8.control_label.multi
												catsmultiselect(ng-model="record.mediaFilter", options="c.name c.dkname group by c.grp for c in mediaFilters",
												ms-header="Select filter").multi													
								div.row
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Lighting
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.mediaLighting", options="c.name c.dkname group by c.grp for c in mediaLightings",
												ms-header="Select lighting").multi	
									div.group.col-sm-6
										div.form-group
											label.col-sm-4.control_label Scope
											div.col-sm-8.control_label.multi
												catsmultiselect(multiple="true", ng-model="record.mediaScope", options="c.name c.dkname group by c.grp for c in mediaScopes",
												ms-header="Select scope").multi
							div
								alert(ng-repeat="alert in alerts", type="{{alert.type}}", close="closeAlert($index)") {{alert.msg}}
				tab(heading="Analysis")
					div.row.embeddedTab
						tabset
							tab(ng-repeat="sampleAnalysis in record.sampleAnalysis", active="sampleAnalysis.active")
								tab-heading
									{{sampleAnalysis.sampleAnalysisType.name}} Analysis 
									a(ng-click="removeAnalysisTab($index)", href=''): i.glyphicon.glyphicon-remove
								div.embeddedTab
									div.row
										div.group.col-sm-6
											div.form-group
												label.col-sm-4.control_label Analysis Method
												div.col-sm-8.control_label.multi
													multiselect(ng-model="sampleAnalysis.sampleAnalysisType", options="c.name for c in analysisTypes",
													ms-header="Select analysis method").multi
									div.row
										div.group.col-sm-12
											div.form-group 
												label.col-sm-2.control_label Description
												div.col-sm-10
													textarea(rows="7", ng-model="sampleAnalysis.sampleAnalysisDescription").form-control
									div.row
										div.group.col-sm-12
											div.form-group 
												label.col-sm-2.control_label Results
												div.col-sm-10
													textarea(rows="5", ng-model="sampleAnalysis.sampleAnalysisResults").form-control
							tab(select="addAnalysis()")
								tab-heading
									i.glyphicon.glyphicon-plus
				tab(heading="Images")
					| Images can be attached here
				tab(heading="Related Artworks")
					div.row.embeddedTab
						tabset
							tab(ng-repeat="relatedartwork in record.relatedartworks", heading="{{relatedartwork.refnumber.name}}", active="relatedartwork.active")
								div.embeddedTab
									div.row
										div.col-sm-4

							tab(select="addArtwork()")
								tab-heading
									i.glyphicon.glyphicon-plus
			div.modal-footer
				p
				label.col-sm-2.checkbox-inline.control_label Create another
					input(type="checkbox", ng-model="createAnother")
				button(type="submit").btn.btn-primary
					span.glyphicon.glyphicon-save
						|Save
				button(ng-click="cancel()").btn.btn-warning 
					span.glyphicon.glyphicon-ban-circle 
						|Cancel
	div.group.row
		div.col-sm-10
			button(popover="The filter is used to enhance your search results by exactly specifying ranges for individual fields", popover-placement="right", popover-trigger="mouseenter", popover-popup-delay="1500").btn.btn-default 
				span.glyphicon.glyphicon-filter 
					|Filter
			button(popover="Remove the search request, results and all filters", popover-trigger="mouseenter", popover-popup-delay="1500").btn.btn-default 
				span.glyphicon.glyphicon-ban-circle 
					|Reset
		div.col-sm-1
			button(ng-click="registerClicked()", popover="Add a new reference sample to the database", popover-trigger="mouseenter", popover-popup-delay="1500").btn.btn-default 
				span.glyphicon.glyphicon-plus 
					|Register

	div.group.row
		p
	div.group.row
		p
	div.group.row
		p
	div.group.row
		table.table.table-hover
			thead
				tr
					h3 Search Results
					br
				tr
					th Reference number
					th Type
					th Institution
					th Location
					th Date
					th Edit
					th Delete
			tbody
				tr(ng-repeat="res in searchResultsList")
					td: a(href='view', ng-click="viewSample(res.sample_record)") {{res.sample_record.referenceNumber}}
					td{{res.sample_record.sampleType.name}}
					td{{res.sample_record.owner.name}}
					td{{res.sample_record.sampleLocation}}
					td{{res.sample_record.sampleDate  | date:'dd-MM-yyyy'}}
					td: button(ng-click="registerClicked()", popover="Edit this sample record", popover-trigger="mouseenter", popover-popup-delay="1000").btn.btn-default
							span.glyphicon.glyphicon-edit 
					td: button(popover="Delete this sample record", popover-trigger="mouseenter", popover-popup-delay="1000").btn.btn-default
							span.glyphicon.glyphicon-remove 
	div.group.row
		div.col-sm-10
		div.col-sm-1
			button(popover="Generate a report of the search results in .pdf format", popover-trigger="mouseenter", popover-popup-delay="1500").btn.btn-default 
				span.glyphicon.glyphicon-print 
					|Report
		div.col-sm-1
			button(popover="Generate and download a .csv file of the search results", popover-trigger="mouseenter", popover-popup-delay="1500").btn.btn-default
				span.glyphicon.glyphicon-download 
					|Export

